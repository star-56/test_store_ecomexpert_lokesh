{% comment %}
  Snippet: product-modal.liquid
  Dynamically populated modal with proper color and size handling
{% endcomment %}


<div class="product-modal" id="productModal" aria-hidden="true">
  <div class="modal-overlay"></div>
  <div class="modal-content">
    <button class="modal-close" aria-label="Close modal">×</button>
    <div class="modal-body">
      <div class="modal-image">
        <img src="https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=120&h=140&fit=crop&crop=center" alt="" id="modalProductImage">
      </div>
      
      <h3 class="modal-title" id="modalProductTitle">Loading...</h3>
      <p class="modal-price" id="modalProductPrice">€0.00</p>
      <p class="modal-description" id="modalProductDescription">Loading product details...</p>
      
      <form class="product-form" id="modalProductForm">
        <div class="variant-selector color-selector">
          <label>Color</label>
          <div class="color-options" id="colorOptions">
            <!-- Colors will be populated dynamically by JavaScript based on product data -->
            <!-- Fallback content in case JavaScript fails -->
            <div class="loading-placeholder">Loading colors...</div>
          </div>
        </div>
        
        <div class="variant-selector size-selector">
          <label>Size</label>
          <div class="size-dropdown-wrapper">
            <select class="size-dropdown" id="sizeOptions">
              <option value="">Loading sizes...</option>
              <!-- Sizes will be populated dynamically by JavaScript based on product data -->
            </select>
            <div class="size-dropdown-arrow"></div>
          </div>
        </div>
        
        <button type="submit" class="add-to-cart-btn">
          ADD TO CART →
        </button>
      </form>
    </div>
  </div>
</div>

<style>
/* Additional styles to ensure proper color display */
/* Additional styles to ensure proper color display */
.variant-selector {
  margin-bottom: 20px;
}

.color-selector {
  margin-bottom: 8px;
  overflow: hidden;
  clear: both;
}

.variant-selector label {
  display: block;
  margin-bottom: 8px;
  font-weight: 500;
}

.color-options {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  margin-bottom: 20px;
  position: relative;
  z-index: 1;
}

.color-option {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  border: 1px solid #ddd;
  background: white;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 14px;
  color: #666;
  position: relative;
  z-index: 2;
  white-space: nowrap;
}

.color-option:hover {
  border-color: #333;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.color-option.selected {
  border-color: #333;
  background-color: #f5f5f5;
  font-weight: 500;
  color: #000;
}

.color-bar {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  border: 1px solid #ddd;
  flex-shrink: 0;
}

.color-option.selected .color-bar {
  border: 2px solid #333;
}

/* Handle white color visibility */
.color-bar[style*="background-color: #FFFFFF"],
.color-bar[style*="background-color: #ffffff"],
.color-bar[style*="background-color: white"] {
  border: 2px solid #ccc;
}

.color-option.selected .color-bar[style*="background-color: #FFFFFF"],
.color-option.selected .color-bar[style*="background-color: #ffffff"],
.color-option.selected .color-bar[style*="background-color: white"] {
  border: 2px solid #333;
}

/* Custom styled dropdown */
.size-selector {
  position: relative;
  clear: both;
}

.size-dropdown-wrapper {
  position: relative;
  display: flex;
  border: 1px solid #ddd;
  border-radius: 4px;
  background: white;
  overflow: hidden;
  z-index: 1;
}

.size-dropdown {
  flex: 1;
  padding: 12px 16px;
  border: none;
  background: transparent;
  font-size: 14px;
  cursor: pointer;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  outline: none;
  min-height: 44px;
}

.size-dropdown-arrow {
  width: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #f8f8f8;
  border-left: 1px solid #ddd;
  cursor: pointer;
  pointer-events: none;
  min-height: 44px;
}

.size-dropdown-arrow::after {
  content: '▼';
  font-size: 14px;
  color: #333;
  font-weight: bold;
}

.size-dropdown-wrapper:hover {
  border-color: #333;
}

.size-dropdown:focus + .size-dropdown-arrow,
.size-dropdown-wrapper:focus-within {
  border-color: #333;
}

.size-dropdown-wrapper:focus-within .size-dropdown-arrow {
  background-color: #f0f0f0;
}

/* Loading states */
.loading-placeholder {
  color: #666;
  font-style: italic;
  padding: 12px 0;
}

/* Ensure size dropdown shows loading state properly */
.size-dropdown option:first-child {
  color: #666;
  font-style: italic;
}
</style>