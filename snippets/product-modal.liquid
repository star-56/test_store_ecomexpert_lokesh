{% comment %}
  Snippet: product-modal.liquid
  Dynamically populated modal with proper color and size handling
  Updated with colored rectangular bars for each color option
{% endcomment %}

<div class="product-modal" id="productModal" aria-hidden="true">
  <div class="modal-overlay"></div>
  <div class="modal-content">
    <button class="modal-close" aria-label="Close modal">×</button>
    <div class="modal-body">
      <div class="modal-image">
        <img src="https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=120&h=140&fit=crop&crop=center" alt="" id="modalProductImage">
      </div>
      
      <h3 class="modal-title" id="modalProductTitle">Loading...</h3>
      <p class="modal-price" id="modalProductPrice">€0.00</p>
      <p class="modal-description" id="modalProductDescription">Loading product details...</p>
      
      <form class="product-form" id="modalProductForm">
        <div class="variant-selector color-selector">
          <label>Color</label>
          <div class="color-options-container" id="colorOptionsContainer">
            <!-- Color options with bars will be populated dynamically by JavaScript -->
            <div class="loading-placeholder">Loading colors...</div>
          </div>
        </div>
        
        <div class="variant-selector size-selector">
          <label>Size</label>
          <select class="size-dropdown" id="sizeOptions">
            <option value="">Loading sizes...</option>
            <!-- Sizes will be populated dynamically by JavaScript based on product data -->
          </select>
        </div>
        
        <button type="submit" class="add-to-cart-btn">
          ADD TO CART →
        </button>
      </form>
    </div>
  </div>
</div>

<style>
/* Additional styles to ensure proper color display */
.color-options {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.color-option {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  border: 1px solid #ddd;
  background: white;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 14px;
}

.color-option:hover {
  border-color: #333;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.color-option.selected {
  border-color: #333;
  background-color: #f5f5f5;
  font-weight: 500;
}

.color-bar {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  border: 1px solid #ddd;
  flex-shrink: 0;
}

.color-option.selected .color-bar {
  border: 2px solid #333;
}

/* Handle white color visibility */
.color-bar[style*="background-color: #FFFFFF"],
.color-bar[style*="background-color: #ffffff"],
.color-bar[style*="background-color: white"] {
  border: 2px solid #ccc;
}

.color-option.selected .color-bar[style*="background-color: #FFFFFF"],
.color-option.selected .color-bar[style*="background-color: #ffffff"],
.color-option.selected .color-bar[style*="background-color: white"] {
  border: 2px solid #333;
}

/* Loading states */
.loading-placeholder {
  color: #666;
  font-style: italic;
  padding: 12px 0;
}

/* Ensure size dropdown shows loading state properly */
.size-dropdown option:first-child {
  color: #666;
  font-style: italic;
}
</style>